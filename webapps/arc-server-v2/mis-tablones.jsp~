<%@page language="java" contentType="text/html" pageEncoding="UTF-8"%>
<%@ page import="java.util.Vector" %>
<%@ page import="arc.User" %>
<%@ page import="arc.Tablon" %>

<!DOCTYPE html>
<html lang="es">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>ARC</title>
	<link href="style.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="messages.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="mis-tablones.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body>


<div id= wrapper> 

<header id="site_head">
  <img id="logo" src="IMG/arc-logo.png">
  <div id="logout">
    <a href="#"><a href="logout"><img id="imgApagado" src="IMG/apagado2.png"></a>
    
<% User user = (User)session.getAttribute("user"); %>

    <p><%= user.getName()%></p>
  </div>
   
<% Vector<Tablon> tablones = (Vector<Tablon>)session.getAttribute("tablones"); 
   Integer tablon=(Integer)request.getAttribute("tablon"); //variable que me identifica que tablon mostrar
   
  //para el formulario, cojo todos los usuarios de la base de datos.
  Vector<User> allUsers =(Vector<User>)request.getAttribute("allUsers");
  Vector<User> moderators = null;
  Vector<User> users = null;

%>

   <nav id="main_nav">
      <ul>
	<li><a href="profile">Perfil</a></li>
	<li><a href="showModifyTablones" class="current" >Mis tablones</a></li>
	<%if(tablones.size()!=0){%><li><a href="getTablones">Mensajes</a></li><%}%>
      </ul>
   </nav>
</header>

<!-- a partir de aqui es lo que varía de una sección a otra -->


<%if(tablones.size()!=0){%>


   <nav id="tablon_name">
      <ul>
	<% for(int i=0;i<tablones.size(); i++){ %>
	      <li>
		  <a href="showModifyTablones?tablonId=<%=i%>" <%if(tablon==i){%>class="current"<%}%>>
		    <%=tablones.elementAt(i).getName()%>
		  </a>
	      </li>
	 	<%}%>
      </ul>
   </nav>
   
<%}%>
   <section id="left">

	 <%if(tablones.size()!=0){%>

	<div class="mensaje">
	  <h2>Nombre de tablón:</h2>
	  <p><%= tablones.elementAt(tablon).getName() %></p>
	</div>
	<p></p>
	<p></p>
	<div class="mensaje">
	  <h2>Moderadores asociados:</h2>

	    <%moderators = tablones.elementAt(tablon).getUsers(); %>
	    <%for(int i = 0; i<moderators.size(); i++){%>
	      <p><%=moderators.elementAt(i).getName()%>
		 <%=moderators.elementAt(i).getSurName1()%>
		 <%=moderators.elementAt(i).getSurName2()%>
              </p>
	    <%}%>
	</div>
	<p></p>
	<div class="mensaje">
	  <h2>Usuarios asociados:</h2>
	  <%users = tablones.elementAt(tablon).getTargetUsers(); %>
	    <%for(int i = 0; i<users.size(); i++){%>
	      <p><%=users.elementAt(i).getName()%>
		 <%=users.elementAt(i).getSurName1()%>
		 <%=users.elementAt(i).getSurName2()%>
		
              </p>
	    <%}%>

	</div>
	<p></p>
	<div class="mensaje">
	  <h2>Permisos asociados a usuario:</h2>
	  <%for(int i = 0; i<users.size(); i++){%>
	      <p><%=users.elementAt(i).getName()%>
		 <%=users.elementAt(i).getSurName1()%>
		 <%=users.elementAt(i).getSurName2()%>
		 ->
		 <%=users.elementAt(i).getPermission()%>
	  <%}%>
              </p>
	</div>

	<%}%>
      

  </section>

  <section id ="right" >
    

   <%if(tablones.size()!=0){%>
      <form method = "post" action= "deleteTablon?tablonId=<%=tablon%>">
      <input id="eliminar" type="submit" value="Eliminar tablón"/>
      </form>
   <%}%>

      <form method="post" action="#">
      <h2>Nombre del tablón:</h2>
      <input type="text" value="<%=tablones.elementAt(tablon).getName()%>"/>
      <p></p>
      <h2>Asociar moderadores: </h2>
      <%for(int i=0;i < allUsers.size(); i++){%>
	<select  multiple="multiple" name="moderators">
	 <option value="<%=allUsers.elementAt(i).getName() + " " +allUsers.elementAt(i).getSurName1() + " " +allUsers.elementAt(i).getSurName2()%>">
	  <%=allUsers.elementAt(i).getName() + " " +allUsers.elementAt(i).getSurName1() + " "+allUsers.elementAt(i).getSurName2()%></option>
	<p></p>
      <%}%>

      <h2>Asociar usuarios: </h2>
      <%for(int i=0;i < allUsers.size(); i++){%>
	<select multiple="multiple" name="targetUsers">
	 <option value="<%=allUsers.elementAt(i).getName() + " " +allUsers.elementAt(i).getSurName1() + " " +allUsers.elementAt(i).getSurName2()%>">
	  <%=allUsers.elementAt(i).getName() + " " +allUsers.elementAt(i).getSurName1() + " "+allUsers.elementAt(i).getSurName2()%></option>
	<p></p>
      <%}%>

      <h2>Asociar permiso a usuario: </h2>


   
    <%if(tablones.size()!=0){%>      
      <input id="modificar" type="button" value="Modificar tablón" />
    <%}%>
      <input id="nuevo" type="button" value="Nuevo tablón" />
            
      </form>
      


  </section>


</div>
</html>
